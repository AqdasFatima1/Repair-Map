<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Crowdsourced Repair Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-geosearch@3.0.0/dist/geosearch.css" />
  <style>
    /* Your previous CSS */
  </style>
</head>
<body>
  <header>
    <h1>Crowdsourced Repair Map</h1>
    <p>This map collects data on informal repair practices and infrastructure in need of care in NYC.<br>
      Click anywhere on the map to share a marker. Add a title, description, optional image, and select the layer it belongs to.<br>
      Use the toggle to view either where repair happens or where it's needed. Use the search bar to find specific locations.
    </p>
  </header>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
  <script src="https://unpkg.com/leaflet-geosearch@3.0.0/dist/bundle.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAiKzc8OGzf3X-AfQbHk6bI6SoKtPvcq2E",
      authDomain: "repair-map-50701.firebaseapp.com",
      projectId: "repair-map-50701",
      storageBucket: "repair-map-50701.appspot.com",
      messagingSenderId: "42233664095",
      appId: "1:42233664095:web:da8ddb442169ed06f8c1ea",
      measurementId: "G-11VNZY8QLX"
    };

    // Initialize Firebase and Firestore
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Create the map
    const map = L.map('map').setView([40.7128, -74.0060], 11);

    // Add tile layer
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; OpenStreetMap contributors & CartoDB',
      maxZoom: 19
    }).addTo(map);

    // Initialize GeoSearch provider and control
    const provider = new GeoSearch.OpenStreetMapProvider();
    const searchControl = new GeoSearch.GeoSearchControl({
      provider: provider,
      style: 'bar',
      showMarker: true,
      retainZoomLevel: false,
      autoClose: true,
      searchLabel: 'Search for a place'
    });
    map.addControl(searchControl);

    // Layers and marker handling code remains unchanged...

  </script>
</body>
</html>
